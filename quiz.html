<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0H45J1R8Z8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0H45J1R8Z8');
</script>

  
  <meta charset="UTF-8">
    <title>Pixel Unblocked Games</title>
    <link rel="icon" href="dogfavi.png">
    <link rel="stylesheet" href="main.css">
    <script src="particles.js"></script>
    <script defer src="script.js"></script>
    <style>
    #game {
      width: 100%;
      height: 500px;
      border: none;
    }
    .embed-container {
      position: relative;
      width: 100%;
      max-width: 900px;
      height: 500px;
      margin: 20px auto;
      border-radius: 15px;
      overflow: hidden;
    }
    .fullscreen-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      border: none;
      padding: 8px 12px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
    }
    .container {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #1a1a1acc;
      padding: 20px;
      border-radius: 25px;
      box-shadow: 0 0 15px 5px white;
      width: fit-content;
      margin: 20px auto;
      width: 400%;
      max-width: 500px;
    }
    .game-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #22222270;
      color: #fff;
      padding: 0 20px 0 10px;
      height: 64px;
      border-top-left-radius: 15px;
      border-top-right-radius: 15px;
      border: 2px solid white;
      border-bottom: none;
      max-width: 900px;
      margin: 20px auto 0 auto;
      box-sizing: border-box;
      position: relative;
      z-index: 2;
    }
    .game-bar-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .game-bar-img {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      object-fit: cover;
      box-shadow: 0 0 8px #0008;
      background: #111;
    }
    .game-bar-title {
      font-size: 1.3rem;
      font-weight: bold;
      letter-spacing: 1px;
      text-shadow: 0 1px 2px #000a;
      white-space: nowrap;
    }
    .game-bar-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .game-bar-controls button {
      box-shadow: 0 2px 8px #0002;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      outline: none;
      transition: background 0.15s, box-shadow 0.15s, border 0.15s, transform 0.12s cubic-bezier(.4,2,.6,1);
      padding: 0;
      margin: 0;
    }
    .game-bar-controls button:hover {
      box-shadow: 0 4px 12px #0003;
    }
    .game-bar-controls button:active {
      transform: scale(0.88);
    }
    .game-bar-controls img {
      width: 24px;
      height: 24px;
      object-fit: contain;
      background: none;
      filter: none;
    }
    .embed-container {
      position: relative;
      width: 100%;
      max-width: 900px;
      height: 500px;
      margin: 0 auto 20px auto;
      border-top: none;
      border-bottom-left-radius: 15px;
      border-bottom-right-radius: 15px;
      border-top-left-radius: 0;
      border-top-right-radius: 0;
      overflow: hidden;
      background-color: white;
      z-index: 1;
    }
    #game {
      width: 100%;
      height: 100%;
      border: none;
      display: none;
      border-bottom-left-radius: 15px;
      border-bottom-right-radius: 15px;
      border-top-left-radius: 0;
      border-top-right-radius: 0;
      background: #fff;
    }
/* Play Overlay (loads iframe only after click) */
#playOverlay{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  background: linear-gradient(0deg, rgba(0,0,0,0.85) 0%, rgba(15,15,15,0.95) 100%);
  z-index: 5;
  user-select:none;
}
#playButton{
  width:110px;
  height:110px;
  border-radius:999px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:56px;
  color:#fff;
  background:#ff3b3b;
  box-shadow: 0 0 30px rgba(255,0,0,0.55);
  transition: transform .15s ease, filter .15s ease;
  line-height:1;
  padding-left:6px;
}
#playOverlay:hover #playButton{ transform: scale(1.06); filter: brightness(1.05); }
#playText{
  margin-top:16px;
  font-size:18px;
  letter-spacing:.5px;
  color:#fff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.7);
}
		.mry_1 {
    margin-top: 15px !important;
	    width: 300px;
    height: 250px;
	margin:0 auto;
}
.mry_2 {
    margin-top: 15px !important;
    width: 970px;
    height: 250px;
	margin:0 auto;
}
  </style>
  <script src="tabcloak.js"></script>
</head>
<script>
	function getScript(src) {
    var headElm = document.head || document.getElementsByTagName('head')[0];
    var script = document.createElement("script");
    var once = true;
    script.async = "async";
    script.type = "text/javascript";
    script.charset = "UTF-8";
    script.src = src;
    script.onload = script.onreadystatechange = function() {
        if (once && (!script.readyState || /loaded|complete/.test(script.readyState))) {
            once = false;         
            script.onload = script.onreadystatechange = null;
			console.log("okeey");
        }
    };
	  headElm.appendChild(script);
}

 
	getScript("//api.adinplay.com/libs/aiptag/pub/GDU/worm.ist/tag.min.js");
 
	window.aiptag = window.aiptag || {cmd: []};
	aiptag.cmd.display = aiptag.cmd.display || [];
	aiptag.cmd.player = aiptag.cmd.player || [];

	//CMP tool settings
	aiptag.cmp = {
		show: true,
		position: "centered",  
		button: true,
		buttonText: "Privacy settings",
		buttonPosition: "bottom-left" //bottom-left, bottom-right, top-left, top-right
	}

	aiptag.cmd.player.push(function() {
		aiptag.adplayer = new aipPlayer({
			AD_WIDTH: 960,
			AD_HEIGHT: 540,
			AD_DISPLAY: 'center', //default, fullscreen, center, fill
			LOADING_TEXT: 'loading advertisement',
			PREROLL_ELEM: function(){return document.getElementById('preroll')},
			AIP_COMPLETE: function (evt){
				 
			},
			AIP_REMOVE: function ()  {
				// Here it's safe to remove the PREROLL_ELEM from the page if you want. But it's not recommend.
			}
		});
	});
	
	 
 
				function show_preroll() {
 					if (typeof aiptag.adplayer !== 'undefined') {
				 	aiptag.cmd.player.push(function() { aiptag.adplayer.startPreRoll(); });
					} else {
				    	 

					}
				}
	
</script>
<div id="preroll"></div>
<body>
  <div id="particles-js"></div>
  <header class="header nav-container">
    <a href="index.html" class="dog-icon-link">
            <img src="dog.png" class="header-img">
        </a>
       <h1 class="header-text header-title">Pixel Unblocked Games</h1>
        <button class="center-button nav-button-large right-fix" onclick="location.href='index.html'">Home</button>
		     <button class="center-button" onclick="window.open('mailto:xmkaram@gmail.com">Contact</button>
            <button class="center-button" onclick="window.open('about.html')">About</button>
            <button class="center-button" onclick="window.open('privacy-policy.html')">Privacy Policy</button>
			<button class="center-button" onclick="window.open('dmca.html')">DMCA</button>
    </header>
<div class="mry_2" id='worm-ist_970x250'>
		<script type='text/javascript'>
			aiptag.cmd.display.push(function() { aipDisplayTag.display('worm-ist_970x250'); });
		</script>
	</div>

  <div id="game-bar" class="game-bar">
    <div class="game-bar-left">
      <img id="game-bar-img" src="" alt="" class="game-bar-img" style="display:none;">
      <span id="game-bar-title" class="game-bar-title"></span>
    </div>
    <div class="game-bar-controls">
      <button onclick="refreshIframe()" title="Refresh"><img src="assets/refresh.png"/></button>
      <button onclick="toggleFullscreen()" title="Fullscreen"><img src="assets/fullscreen.png"/></button>
    </div>
  </div>
  <div class="embed-container" id="embedWrapper">
    <div id="playOverlay" role="button" aria-label="Play game">
      <div onclick="show_preroll();" id="playButton">â–¶</div>
      <div id="playText">Click to Play</div>
    </div>
    <iframe id="game" data-src="" allowfullscreen></iframe>
  </div>
  <script src="gamesData.js?v=20260110"></script>
  <script>
    function getGameByLessonId(lessonId) {
      const list = (typeof games !== 'undefined' && Array.isArray(games)) ? games : (Array.isArray(window.games) ? window.games : null);
      if (!list) return null;
      return list.find(g => Number(g.id) === Number(lessonId));
    }

    function getGameByLegacyParam(gameParam) {
      if (typeof games === 'undefined' || !Array.isArray(games)) return null;
      // Support both identifier (e.g. "run-3") and iframe path (e.g. "https://cdn-json.us/g/load/run3/index.html")
      return games.find(g => g.identifier === gameParam || g.iframe === gameParam);
    }

    function setGameContent() {
      const params = new URLSearchParams(window.location.search);

      // New system: ?lessons=1
      const lessonIdRaw = params.get('lessons');
      const lessonId = lessonIdRaw ? parseInt(lessonIdRaw, 10) : NaN;

      // Legacy support: ?game=identifier OR ?game=iframePath
      const legacyGame = params.get('game');

      // If legacy URL is used, redirect to new URL once (keeps SEO clean)
      if ((!lessonIdRaw || Number.isNaN(lessonId)) && legacyGame) {
        const legacyObj = getGameByLegacyParam(legacyGame);
        if (legacyObj && legacyObj.id) {
          window.location.replace('quiz.html?lessons=' + legacyObj.id);
          return;
        }
      }

      const gameObj = getGameByLessonId(lessonId);

      const iframe = document.getElementById("game");
      const barImg = document.getElementById("game-bar-img");
      const barTitle = document.getElementById("game-bar-title");

      if (gameObj) {
        iframe.dataset.src = gameObj.iframe;
        iframe.removeAttribute('src');
        iframe.style.display = 'none';
        const overlay = document.getElementById('playOverlay');
        if (overlay) overlay.style.display = 'flex';
        barImg.src = gameObj.img;
        barTitle.textContent = gameObj.name;
        document.title = gameObj.name + " | Quiz Math 70";
      } else {
        iframe.src = 'about:blank';
        const overlay = document.getElementById('playOverlay');
        if (overlay) overlay.style.display = 'none';
        iframe.style.display = 'block';
        barImg.src = 'dog.png';
        barTitle.textContent = 'Lesson not found';
        document.title = "Lesson not found | Quiz Math 70";
      }
    }
// Wire play overlay (idempotent)
(function bindPlayOverlay(){
  const overlay = document.getElementById('playOverlay');
  if (!overlay || overlay.dataset.bound) return;
  overlay.dataset.bound = '1';
  overlay.addEventListener('click', () => {
    const frame = document.getElementById('game');
    const src = frame.dataset.src;
    if (src) {
      frame.src = src;
      frame.style.display = 'block';
      overlay.style.display = 'none';
    }
  });
})();


    window.addEventListener('DOMContentLoaded', setGameContent);

    function refreshIframe() {
      const iframe = document.getElementById("game");
      const overlay = document.getElementById("playOverlay");
      // If not started yet, start the game on refresh
      if (!iframe.src || iframe.src === 'about:blank') {
        if (iframe.dataset.src) {
          iframe.src = iframe.dataset.src;
          iframe.style.display = "block";
          if (overlay) overlay.style.display = "none";
        }
        return;
      }
      iframe.src = iframe.src;
    }
    function toggleFullscreen() {
      const iframe = document.getElementById("game");
      if (!document.fullscreenElement) {
        if (iframe.requestFullscreen) {
          iframe.requestFullscreen();
        } else if (iframe.mozRequestFullScreen) {
          iframe.mozRequestFullScreen();
        } else if (iframe.webkitRequestFullscreen) {
          iframe.webkitRequestFullscreen();
        } else if (iframe.msRequestFullscreen) {
          iframe.msRequestFullscreen();
        }
      } else {
        if (document.exitFullscreen) {
          document.exitFullscreen();
        }
      }
    }
  </script>
</body>

